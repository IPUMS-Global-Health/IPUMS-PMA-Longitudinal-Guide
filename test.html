<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width">
<meta property="og:title" content="test.knit" />






<meta name="description" content="test.knit">

<script id="pandoc-meta" type="application/json">
{"newpage_html_class":"page-break-after","cap-location":"margin","toc-title":"Contents","lof":false,"toc":true,"paged-footnotes":true,"css":["css/layout.css","css/fix-pagedown.css","css/fonts.css"],"lot":false,"output":{"pagedown::html_paged":{"self_contained":false,"toc":true}}}
</script>

<title>test.knit</title>


<link href="test_files/paged-0.19/css/default-fonts.css" rel="stylesheet" />
<link href="test_files/paged-0.19/css/default-page.css" rel="stylesheet" />
<link href="test_files/paged-0.19/css/default.css" rel="stylesheet" />
<script src="test_files/paged-0.19/js/config.js"></script>
<script src="test_files/paged-0.19/js/paged.js"></script>
<script src="test_files/paged-0.19/js/hooks.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/layout.css" type="text/css" />
<link rel="stylesheet" href="css/fix-pagedown.css" type="text/css" />
<link rel="stylesheet" href="css/fonts.css" type="text/css" />

</head>

<body>

<div class="running-h1-title"></div>

<div class="running-h2-title"></div>



<div class="front-page">
</div>

<div class="front-matter-container">
<div id="TOC" class="level1 toc front-matter">
<h1 class="toc-title">Contents</h1>
<ul>
<li><a href="#longitudinal-data-extracts"><span class="toc-section-number">1</span> Longitudinal Data Extracts</a>
<ul>
<li><a href="#sample-selection"><span class="toc-section-number">1.1</span> Sample Selection</a></li>
<li><a href="#variable-selection"><span class="toc-section-number">1.2</span> Variable Selection</a>
<ul>
<li><a href="#codes"><span class="toc-section-number">1.2.1</span> Codes</a></li>
<li><a href="#variable-description"><span class="toc-section-number">1.2.2</span> Variable Description</a></li>
<li><a href="#comparability-notes"><span class="toc-section-number">1.2.3</span> Comparability Notes</a></li>
<li><a href="#sample-universe"><span class="toc-section-number">1.2.4</span> Sample Universe</a></li>
<li><a href="#availability-across-samples"><span class="toc-section-number">1.2.5</span> Availability Across Samples</a></li>
<li><a href="#questionnaire-text"><span class="toc-section-number">1.2.6</span> Questionnaire Text</a></li>
<li><a href="#checkout"><span class="toc-section-number">1.2.7</span> Checkout</a></li>
</ul></li>
<li><a href="#data-for-r-users"><span class="toc-section-number">1.3</span> Data for R Users</a>
<ul>
<li><a href="#select-a-fixed-width-file"><span class="toc-section-number">1.3.1</span> Select a Fixed-width File</a></li>
<li><a href="#download"><span class="toc-section-number">1.3.2</span> Download</a></li>
</ul></li>
<li><a href="#long-data-structure"><span class="toc-section-number">1.4</span> Long Data Structure</a></li>
<li><a href="#wide-data-structure"><span class="toc-section-number">1.5</span> Wide Data Structure</a></li>
<li><a href="#which-format-is-best-for-me"><span class="toc-section-number">1.6</span> Which format is best for me?</a></li>
</ul></li>
</ul>
</div>
</div>

<div class="main">
<div id="longitudinal-data-extracts" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Longitudinal Data Extracts</h1>
<p>This chapter provides a guided tour of the <a href="https://pma.ipums.org/pma/">IPUMS PMA data extract system</a>. While you may also access the original data directly from our partners at <a href="https://www.pmadata.org/">PMA</a>, harmonized data from IPUMS have a few additional features. For instance, you can request an extract that:</p>
<aside>
<a href="https://pma.ipums.org/pma/register.shtml">Register here</a> to access IPUMS PMA data <strong>at no cost.</strong> See our <a href="https://pma.ipums.org/pma/userguide.shtml">user guide</a> for details.
</aside>
<ul>
<li>includes samples from multiple countries<br />
</li>
<li>includes samples from multiple rounds of data collection</li>
<li>are formatted in either <strong>long</strong> or <strong>wide</strong> format</li>
</ul>
<p>IPUMS PMA also makes it easy to switch between multiple <a href="https://pma.ipums.org/pma-action/variables/group">units of analysis</a> covered in PMA surveys. In addition to the data featured in this guide, you’ll find surveys representing:</p>
<aside>
A video tour of the longitudinal extract system is available <a href="https://www.youtube.com/embed/VwjYHDvpHk0">here</a> on the IPUMS PMA Youtube channel.
</aside>
<ul>
<li><a href="https://tech.popdata.org/pma-data-hub/#category:Service_Delivery_Points">Service Delivery Points (SDPs)</a></li>
<li><a href="https://tech.popdata.org/pma-data-hub/#category:Client_Exit_Interviews">Client Exit Interviews conducted at SDPs</a></li>
<li>Participants in special surveys covering topics like <a href="https://tech.popdata.org/pma-data-hub/#category:COVID-19">COVID-19</a>, <a href="https://tech.popdata.org/pma-data-hub/#category:Nutrition">nutrition</a>, and maternal &amp; newborn health</li>
</ul>
<p>To get started with a longitudinal data extract, you’ll need to select the <strong>Family Planning</strong> topic under the <strong>Person</strong> unit of analysis.</p>
<p><img src="images/unit.png" width="85%" style="display: block; margin: auto;" /></p>
<div id="sample-selection" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Sample Selection</h2>
<p>Once you’ve selected the <strong>Family Planning</strong> option, you’ll next need to choose between cross-sectional or longitudinal samples. Cross-sectional samples are selected by default; these are nationally or sub-nationally representative samples collected each year dating backward as far as 2013.</p>
<p><img src="images/cross-sectional.png" width="85%" style="display: block; margin: auto;" /></p>
<aside>
Annual cross-sectional samples are also available for each of the countries participating in the new PMA panel study. See our <a href="../2022-03-01-phase2-discovery/">last post</a> for details.
</aside>
<p>Longitudinal samples are only available from 2019 onward, and they include all of the available phases for each sampled country (sub-nationally representative samples for DRC and Nigeria are listed separately). You’ll only find longitudinal samples for countries where Phase 2 data has been made available; Phase 1 data for Cote d’Ivoire, India, and Uganda can currently be found under the Cross-sectional sample menu (Phase 2 data will be released soon!).</p>
<div class="page-break-after"></div>
<p>Clicking the Longitudinal button reveals options for either <strong>long</strong> or <strong>wide</strong> format. You’ll find the same samples available in either case.</p>
<p><strong>Important:</strong> if you decide to change formats after selecting variables, your Data Cart will be emptied and you’ll need to begin again from scratch.</p>
<p><img src="images/wide.png" width="85%" style="display: block; margin: auto;" /></p>
<div class="page-break-after"></div>
<p>After you’ve selected one of the available longitudinal formats, choose one or more samples listed below. There are also several Sample Members options listed.</p>
<p><img src="images/cases.png" width="85%" style="display: block; margin: auto;" /></p>
<aside>
<p><a href="https://pma.ipums.org/pma-action/variables/PANELWOMAN#codes_section">PANELWOMAN</a> indicates whether an individual is a member of the panel study.</p>
<a href="https://pma.ipums.org/pma-action/variables/RESULTFQ#codes_section">RESULTFQ</a> indicates whether an individual completed the Female Questionnaire.
</aside>
<p><strong>Female Respondents</strong> only includes women who completed <em>all or part</em> of a Female Questionnaire. <strong>This option selects all members of the panel study.</strong> In addition, it includes women who only participated in only one phase - we will demonstrate how to identify and drop these cases below.<span id="fn1" class="footnote" data-pagedown-footnote-number="1" style="white-space: pre-line;">Women who completed all or part of the Female Questionnaire in <em>more than one phase</em> of the study are considered <strong>panel members</strong>. Women who completed it only at Phase 1 are included in a longitudinal extract, but they are not <strong>panel members</strong>. Likewise, women who completed it for the first time at Phase 2 are included, but are not <strong>panel members</strong> if they 1) will reach age 50 before Phase 3, or 2) declined the invitation to participate again in Phase 3.</span></p>
<p><strong>Female Respondents and Female Non-respondents</strong> includes all women who were eligible to participate in a Female Questionnaire. Eligible women are those age 15-49 who were listed on the roster collected in a Household Questionnaire. If an eligible woman declined the Female Questionnaire or was not available, variables associated with that questionnaire will be coded “Not interviewed (female questionnaire)”.</p>
<div class="page-break-after"></div>
<aside>
<p><a href="https://pma.ipums.org/pma-action/variables/ELIGIBLE#codes_section">ELIGIBLE</a> indicates whether an individual was eligible for the female questionnaire.</p>
<a href="https://pma.ipums.org/pma-action/variables/RESULTHQ#codes_section">RESULTHQ</a> indicates whether a member of the individual’s household completed the Household Questionnaire.
</aside>
<p><strong>Female Respondents and Household Members</strong> adds records for all other members of a Female Respondent’s household. These household members did not complete the Female Questionnaire, but were listed on the household roster provided by the respondent to a Household Questionnaire. Basic <a href="https://internal.pma.ipums.org/pma-action/variables/group?id=hh_roster">demographic</a> variables are available for each household member, as are common <a href="https://internal.pma.ipums.org/pma-action/variables/group?id=hh_wealth">wealth</a>, <a href="https://internal.pma.ipums.org/pma-action/variables/group?id=water_watersource">water</a>, <a href="https://internal.pma.ipums.org/pma-action/variables/group?id=water_wash">sanitation</a>, and other variables shared for all members of the same household.</p>
<p><strong>All Cases</strong> includes all members listed on the household roster from a Household Questionnaire. If the Household Questionnaire was declined or if no respondent was available, any panel member appearing in other phases of the study will be coded “Not interviewed (household questionnaire)” for variables associated with the missing Household Questionnaire.</p>
<p>After you’ve selected samples and sample members for your extract, click the “Submit Sample Selections” button to return to the main data browsing menu.</p>
</div>
<div id="variable-selection" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Variable Selection</h2>
<p>You can browse IPUMS PMA variables by topic or alphabetically by name, or you can <a href="https://pma.ipums.org/pma-action/variables/search">search</a> for a particular term in a variable name, label, value labels, or description.</p>
<p><img src="images/topics.png" width="85%" style="display: block; margin: auto;" /></p>
<div class="page-break-after"></div>
<p>In this example, we’ll select the <a href="https://pma.ipums.org/pma-action/variables/group?id=fem_fpst">Discontinuation of Family Planning</a> topic. The availability of each associated variable is shown in a table containing all of the samples we’ve selected.</p>
<ul>
<li><code>X</code> indicates that the variable is available for <em>all phases</em></li>
<li><code>/</code> indicates that the variable is available for <em>one phase</em></li>
<li><code>-</code> indicates that the variable is not available for <em>any phase</em></li>
</ul>
<p>You can click the <code>+</code> button to add a variable to your cart, or click a variable name to learn more.</p>
<p><img src="images/table.png" width="85%" style="display: block; margin: auto;" /></p>
<div id="codes" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Codes</h3>
<aside>
“Case-count view” is not available for longitudinal samples, where each sample includes data from multiple phases. For cross-sectional samples, this option shows the frequency of each response.
</aside>
<p>Let’s take a look at the variable <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#codes_section">PREGNANT</a>. You’ll find the variable name and label shown at the top of the page. Below, you’ll see several tabs beginning with the <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#codes_section">CODES</a> tab. For discrete variables, this tab shows all of the available codes and value labels associated with each response. You’ll also see the same <code>X</code>, <code>/</code>, and <code>-</code> symbols in a table indicating the availability of each response in each sample.</p>
<p><img src="images/codes-fr.png" width="85%" style="display: block; margin: auto;" /></p>
<div class="page-break-after"></div>
<p>Above, there are no responses for “Not interviewed (female questionnaire)” and “Not interviewed (household questionnaire)”; this is because only samples members included in a “Female Respondents” extract are displayed by default. If we instead choose “All Cases”, this variable will include those response options because we’ll include every person listed on the household roster (even if the Household or Female Questionnaire was not completed).</p>
<p><img src="images/codes-all.png" width="85%" style="display: block; margin: auto;" /></p>
<div class="page-break-after"></div>
<p>The symbol <code>/</code> again indicates that a particular response is available for some - but not all - phases of the study. For <code>PREGNANCY</code> it indicates that one of the options was either unavailable or was not selected by any sample respondents in a particular phase. If a variable was not included in all phases of the study, all response options will be marked with this symbol. For example, consider the variable <a href="https://pma.ipums.org/pma-action/variables/COVIDCONCERN#codes_section">COVIDCONCERN</a>, indicating the respondent’s level of concern about becoming infected with COVID-19.</p>
<p><img src="images/covidconcern.png" width="85%" style="display: block; margin: auto;" /></p>
<p>Because Phase 1 questionnaires were administered prior to the emergence of COVID-19, this variable only appeared on Phase 2 questionnaires. The symbol <code>/</code> indicates limited availability across phases.</p>
</div>
<div id="variable-description" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Variable Description</h3>
<p>You’ll find a detailed description for each variable on the <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#description_section">DESCRIPTION</a> tab. This tab also indicates whether a particular question appeared on the Household or Female Questionnaire.</p>
<p><img src="images/desc.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<div id="comparability-notes" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Comparability Notes</h3>
<p>The <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#comparability_section">COMPARABILITY</a> tab describes important differences between samples. Additionally, it may contain information about similar variables appearing in <a href="https://dhsprogram.com/">DHS</a> samples provided by <a href="https://www.idhsdata.org/idhs/">IPUMS DHS</a>.</p>
<p><img src="images/comp.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<div id="sample-universe" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Sample Universe</h3>
<p>The <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#universe_section">UNIVERSE</a> tab describes selection criteria for this question. In this case, there are some differences between samples:</p>
<ul>
<li>In DRC samples, all women aged 15-49 received this question.</li>
<li>For all other samples, the question was skipped if any such woman previously indicated that she was menopausal or had a hysterectomy.</li>
</ul>
<p><img src="images/universe.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<div id="availability-across-samples" class="section level3" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> Availability Across Samples</h3>
<p>The <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#availability_section">AVAILABILITY</a> tab shows all other samples (including cross-sectional samples) where this variable is available.</p>
<p><img src="images/avail.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<div id="questionnaire-text" class="section level3" number="1.2.6">
<h3><span class="header-section-number">1.2.6</span> Questionnaire Text</h3>
<p>Finally, you’ll find the full text of each question on the <a href="https://pma.ipums.org/pma-action/variables/PREGNANT#questionnaire_text_section">QUESTIONNAIRE TEXT</a> tab. Each phase of the survey is shown separately, and you may click the “view entire document: text” link to view the complete questionnaire for a particular sample in any given phase.</p>
<p><img src="images/question.png" width="85%" style="display: block; margin: auto;" /></p>
</div>
<div id="checkout" class="section level3" number="1.2.7">
<h3><span class="header-section-number">1.2.7</span> Checkout</h3>
<p>Use the buttons at the top of this page to add the variable to your Data Cart, or to “VIEW CART” and begin checkout.</p>
<img src="images/buttons.png" style="margin-top: 20px; margin-bottom: 25px; max-width: 100%; width: 1033px;"/>
</div>
</div>
<div id="data-for-r-users" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Data for R Users</h2>
<p>Your Data Cart shows all of the variables you’ve selected, plus several “preselected” variables that will be automatically included in your extract. Click the “CREATE DATA EXTRACT” button to prepare your download.</p>
<p><img src="images/cart.png" width="85%" style="display: block; margin: auto;" /></p>
<div id="select-a-fixed-width-file" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Select a Fixed-width File</h3>
<p>Before you submit an extract request, you’ll have the opportunity to choose a “Data Format”. <strong>R users should selected Fixed-width text (.dat)</strong> - you’ll notice that data formatted for Stata, SPSS, and SAS are also available. CSV files are provided, but not recommended. (If you wish to change Sample Members, you may do so again here.)</p>
<p><img src="images/checkout1.png" width="85%" style="display: block; margin: auto;" /></p>
<p>Once the Fixed-width option is selected, you may add a description and then proceed to the download page.</p>
</div>
<div id="download" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Download</h3>
<p>After a few moments, you’ll receive an email indicating that your extract has been created. You’ll need to obtain two files from the download page:</p>
<ul>
<li>Click the green “Download DAT” button to download the data file. You’ll receive a file with a number like <code>pma_00001.dat.gz</code>.<br />
</li>
<li>Right click on “DDI” and click “Save link as”. You’ll receive a corresponding XML file like <code>pma_00001.xml</code>.</li>
</ul>
<img src="images/download.png" style="margin-top: 20px; margin-bottom: 25px;"/>
<p>Place both files in a folder that R can use as its <a href="https://r4ds.had.co.nz/workflow-projects.html?q=working%20directory#where-does-your-analysis-live">working directory</a>. We <strong>strongly recommend</strong> using <a href="https://r4ds.had.co.nz/workflow-projects.html?q=working%20directory#rstudio-projects">RStudio projects</a> to manage all of the files and analysis scripts used for a particular research project. We’ll place our files in a subfolder called “data” within our own RStudio project folder.</p>
<p>Open RStudio (or R) and load the packages <a href="https://www.ipums.org">ipumsr</a> and <a href="https://tidyverse.tidyverse.org">tidyverse</a>. If you are not using an RStudio project, you will need to change your working directory to match the location of your downloaded files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipumsr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Downloads&quot;</span>) <span class="co"># ONLY if not using an RStudio project (change as needed)</span></span></code></pre></div>
<p>We’ll now demonstrate loading both a long and a wide extract, and we’ll take a brief look at the structure of each.</p>
</div>
</div>
<div id="long-data-structure" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Long Data Structure</h2>
<p>We’ve downloaded a <strong>long</strong> data extract (Female Respondents only) and saved it in a folder called “data” in our working directory. We’ll now load it into R as an object called <code>long</code>.</p>
<p>To load an IPUMS PMA extract into R, you’ll need to reference <em>both</em> the DDI file <em>and</em> the fixed-width data file in the function <a href="https://rdrr.io/pkg/ipumsr/man/read_ipums_micro.html">read_ipums_micro</a> from <code>ipumsr</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ddi =</span> <span class="st">&quot;data/pma_00095.xml&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="st">&quot;data/pma_00095.dat.gz&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>In a <strong>long</strong> extract, data from each phase will be organized in <em>separate rows</em>. Here, responses from three panel members are shown:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>long <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FQINSTID <span class="sc">%&gt;%</span> <span class="fu">str_starts</span>(<span class="st">&quot;011&quot;</span>) <span class="sc">|</span> FQINSTID <span class="sc">%&gt;%</span> <span class="fu">str_starts</span>(<span class="st">&quot;015&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(FQINSTID) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FQINSTID, PHASE, AGE, PANELWOMAN)</span></code></pre></div>
<pre><code># A tibble: 6 × 4
  FQINSTID                  PHASE               AGE       PANELWOMAN
  &lt;chr&gt;                     &lt;int+lbl&gt;           &lt;int+lbl&gt; &lt;int+lbl&gt; 
1 011W5S0HN91I4H4I3T9JCMBHB 1 [Baseline]        29        NA        
2 011W5S0HN91I4H4I3T9JCMBHB 2 [First follow up] 30         1 [Yes]  
3 015NP6FJTIA98FYCBBBS1FOF7 1 [Baseline]        47        NA        
4 015NP6FJTIA98FYCBBBS1FOF7 2 [First follow up] 48         1 [Yes]  
5 015WYNNO2WXHH6JA4HA9PL1MR 1 [Baseline]        20        NA        
6 015WYNNO2WXHH6JA4HA9PL1MR 2 [First follow up] 21         1 [Yes]  </code></pre>
<p>Each panel member receives a unique ID shown in <a href="https://pma.ipums.org/pma-action/variables/FQINSTID#codes_section">FQINSTID</a>. The variable <a href="https://pma.ipums.org/pma-action/variables/PHASE#codes_section">PHASE</a> shows that each woman’s responses to the Phase 1 Female Questionnaire appears in the first row, while her Phase 2 responses appear in the second. <a href="https://pma.ipums.org/pma-action/variables/AGE#codes_section">AGE</a> shows each woman’s age when she completed the Female Questionnaire for each phase.</p>
<p><a href="https://pma.ipums.org/pma-action/variables/PANELWOMAN#codes_section">PANELWOMAN</a> indicates whether the woman completed all or part of the Female Questionnaire in a <em>prior</em> phase, and that she’d agreed to continue participating in the panel study at that time. The value <code>NA</code> appears in the rows for Phase 1, as <code>PANELWOMAN</code> was not included in Phase 1 surveys.</p>
<div class="page-break-after"></div>
<p>We mentioned above that you’ll also include responses from some non-panel members when you request an extract with Female Respondents. These include women who did not complete all or part the Female Questionnaire in a prior phase, as indicated by <a href="https://pma.ipums.org/pma-action/variables/PANELWOMAN#codes_section">PANELWOMAN</a>. These women are not assigned a value for <a href="https://pma.ipums.org/pma-action/variables/FQINSTID#codes_section">FQINSTID</a> - instead, you’ll find an empty string:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>long <span class="sc">%&gt;%</span> <span class="fu">count</span>(PHASE, PANELWOMAN, FQINSTID <span class="sc">==</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 × 4
  PHASE               PANELWOMAN `FQINSTID == &quot;&quot;`     n
  &lt;int+lbl&gt;           &lt;int+lbl&gt;  &lt;lgl&gt;            &lt;int&gt;
1 1 [Baseline]        NA         FALSE            23591
2 2 [First follow up]  0 [No]    TRUE              6586
3 2 [First follow up]  1 [Yes]   FALSE            18194</code></pre>
<p>For most longitudinal analysis applications, you’ll need to drop non-panel members together with any women who did not fully complete the Phase 2 Female Questionnaire. We’ll demonstrate using <a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a> to ensure that there is one row for every <a href="https://pma.ipums.org/pma-action/variables/FQINSTID#codes_section">FQINSTID</a> where <code>PHASE == 1</code> and another row where <code>PHASE == 2 &amp; RESULTFQ == 1</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> long <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FQINSTID) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(PHASE <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> <span class="fu">any</span>(PHASE <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> RESULTFQ <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
<p>The <a href="../2022-03-01-phase2-discovery/index.html#inclusion-criteria-for-analysis">PMA Longitudinal Briefs</a> published for each sample also include only members of the <em>de facto</em> population. These are women who slept in the household during the night prior to the interview for each Household Questionnaire, such that <a href="https://pma.ipums.org/pma-action/variables/RESIDENT#codes_section">RESIDENT</a> takes the value <code>11</code> or <code>22</code>. We’ll use <a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a> again to include only <em>de facto</em> women from both phases.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> long <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FQINSTID) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">all</span>(RESIDENT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">22</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
<div class="page-break-after"></div>
<p>Following these steps, you can check the size of each analytic sample like so. (Reminder: samples for DRC and Nigeria are sub-nationally representative, so we’ll show separate frequencies for each <a href="https://pma.ipums.org/pma-action/variables/GEOCD#codes_section">GEOCD</a> and <a href="https://pma.ipums.org/pma-action/variables/GEONG#codes_section">GEONG</a>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>long <span class="sc">%&gt;%</span> <span class="fu">count</span>(COUNTRY, GEOCD, GEONG, PHASE)</span></code></pre></div>
<pre><code># A tibble: 12 × 5
   COUNTRY                        GEOCD              GEONG      PHASE                  n
   &lt;int+lbl&gt;                      &lt;int+lbl&gt;          &lt;int+lbl&gt;  &lt;int+lbl&gt;          &lt;int&gt;
 1 1 [Burkina Faso]               NA                 NA         1 [Baseline]        5212
 2 1 [Burkina Faso]               NA                 NA         2 [First follow u…  5212
 3 2 [Congo, Democratic Republic]  1 [Kinshasa]      NA         1 [Baseline]        1973
 4 2 [Congo, Democratic Republic]  1 [Kinshasa]      NA         2 [First follow u…  1973
 5 2 [Congo, Democratic Republic]  2 [Kongo Central] NA         1 [Baseline]        1514
 6 2 [Congo, Democratic Republic]  2 [Kongo Central] NA         2 [First follow u…  1514
 7 7 [Kenya]                      NA                 NA         1 [Baseline]        6939
 8 7 [Kenya]                      NA                 NA         2 [First follow u…  6939
 9 9 [Nigeria]                    NA                  2 [Lagos] 1 [Baseline]        1089
10 9 [Nigeria]                    NA                  2 [Lagos] 2 [First follow u…  1089
11 9 [Nigeria]                    NA                  4 [Kano]  1 [Baseline]         998
12 9 [Nigeria]                    NA                  4 [Kano]  2 [First follow u…   998</code></pre>
</div>
<div id="wide-data-structure" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Wide Data Structure</h2>
<p>We’ve also downloaded a <strong>wide</strong> data extract (Female Respondents only) and saved it in the “data” folder in our working directory. We’ll also load this extract into R as an object named <code>wide</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ddi =</span> <span class="st">&quot;data/pma_00084.xml&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="st">&quot;data/pma_00084.dat.gz&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>In a <strong>wide</strong> extract, all of the responses from one woman appear in the <em>same row</em>. The IPUMS extract system appends a numeric suffix to each variable name corresponding with the phase from which it was drawn. Consider our three example panel members again:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>wide <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FQINSTID <span class="sc">%&gt;%</span> <span class="fu">str_starts</span>(<span class="st">&quot;011&quot;</span>) <span class="sc">|</span> FQINSTID <span class="sc">%&gt;%</span> <span class="fu">str_starts</span>(<span class="st">&quot;015&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FQINSTID, AGE_1, AGE_2, PANELWOMAN_1, PANELWOMAN_2)</span></code></pre></div>
<pre><code># A tibble: 3 × 5
  FQINSTID                  AGE_1     AGE_2     PANELWOMAN_1 PANELWOMAN_2
  &lt;chr&gt;                     &lt;int+lbl&gt; &lt;int+lbl&gt; &lt;int+lbl&gt;    &lt;int+lbl&gt;   
1 011W5S0HN91I4H4I3T9JCMBHB 29        30        NA           1 [Yes]     
2 015NP6FJTIA98FYCBBBS1FOF7 47        48        NA           1 [Yes]     
3 015WYNNO2WXHH6JA4HA9PL1MR 20        21        NA           1 [Yes]     </code></pre>
<p>Each panel member has one unique ID shown in <a href="https://pma.ipums.org/pma-action/variables/FQINSTID#codes_section">FQINSTID</a>. However, <a href="https://pma.ipums.org/pma-action/variables/AGE#codes_section">AGE</a> is parsed into two columns: <code>AGE_1</code> shows each woman’s age at Phase 1, and <code>AGE_2</code> shows her age at Phase 2.</p>
<p>As we’ve discussed, <a href="https://pma.ipums.org/pma-action/variables/PANELWOMAN#codes_section">PANELWOMAN</a> is not available for Phase 1, as it indicates whether the woman completed all or part of the Female Questionnaire in a <em>prior</em> phase. For this reason, all values in <code>PANELWOMAN_1</code> are <code>NA</code>. Most variables are copied once for each phase, even if they - like <code>PANELWOMAN_1</code> - are not available for all phases.</p>
<div class="page-break-after"></div>
<p>You might expect the total length of a <strong>wide</strong> extract to be half the length of a corresponding <strong>long</strong> extract. This is not the case! A <strong>wide</strong> extract includes one row for each woman who completed all or part of the Female Questionnaire <em>for any phase</em> - you’ll find placeholder columns for phases where the interview was not conducted.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>wide <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FQINSTID <span class="sc">==</span> <span class="st">&quot;0C8VQU6B03BXLAVVZ8SB90EKQ&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RESULTFQ_1, AGE_1, RESULTFQ_2, AGE_2)</span></code></pre></div>
<pre><code># A tibble: 1 × 4
  RESULTFQ_1    AGE_1     RESULTFQ_2      AGE_2                                      
  &lt;int+lbl&gt;     &lt;int+lbl&gt; &lt;int+lbl&gt;       &lt;int+lbl&gt;                                  
1 1 [Completed] 31        2 [Not at home] 95 [Not interviewed (female questionnaire)]</code></pre>
<p>In a <strong>long</strong> extract, rows for the missing phase are dropped. In this example, the woman was “not at home” for the Phase 2 Female Questionnaire. When we select a <strong>long</strong> extract containing only Female Respondents, her Phase 2 row is excluded automatically (it will be included if you request an extract containing Female Respondents and Female Non-respondents).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>long <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(FQINSTID <span class="sc">==</span> <span class="st">&quot;0C8VQU6B03BXLAVVZ8SB90EKQ&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PHASE, RESULTFQ, AGE)</span></code></pre></div>
<pre><code># A tibble: 1 × 3
  PHASE        RESULTFQ      AGE      
  &lt;int+lbl&gt;    &lt;int+lbl&gt;     &lt;int+lbl&gt;
1 1 [Baseline] 1 [Completed] 31       </code></pre>
<p>Again: for most longitudinal analysis applications, you’ll need to remove cases where women were not interviewed for Phase 1 or where the Phase 2 Female Questionnaire was not completed:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> wide <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RESULTFQ_2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RESULTFQ_1)) </span></code></pre></div>
<p>The <em>de facto</em> population appearing in <a href="../2022-03-01-phase2-discovery/index.html#inclusion-criteria-for-analysis">PMA Longitudinal Briefs</a> is defined in <strong>wide</strong> extracts by cases where the values <code>11</code> or <code>12</code> appear in <em>both</em> <code>RESIDENT_1</code> and <code>RESIDENT_2</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wide <span class="ot">&lt;-</span> wide <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RESIDENT_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">22</span>) <span class="sc">&amp;</span> RESIDENT_2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">22</span>))</span></code></pre></div>
<div class="page-break-after"></div>
<p>Following these steps, each analytic sample contains the same number of cases shown in the final <strong>long</strong> format extract above.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wide <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(COUNTRY, GEOCD, GEONG) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 4
# Groups:   COUNTRY, GEOCD, GEONG [6]
  COUNTRY                        GEOCD              GEONG          n
  &lt;int+lbl&gt;                      &lt;int+lbl&gt;          &lt;int+lbl&gt;  &lt;int&gt;
1 1 [Burkina Faso]               NA                 NA          5212
2 2 [Congo, Democratic Republic]  1 [Kinshasa]      NA          1973
3 2 [Congo, Democratic Republic]  2 [Kongo Central] NA          1514
4 7 [Kenya]                      NA                 NA          6939
5 9 [Nigeria]                    NA                  2 [Lagos]  1089
6 9 [Nigeria]                    NA                  4 [Kano]    998</code></pre>
</div>
<div id="which-format-is-best-for-me" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Which format is best for me?</h2>
<p>The choice between <strong>long</strong> and <strong>wide</strong> formats ultimately depends on your research objectives.</p>
<p>Many data manipulation tasks, for example, are faster and easier to perform in the <strong>wide</strong> format. In the example above, we needed to identify women who completed a Female Questionnaire and were members of the <em>de facto</em> population in both phases. In the <strong>long</strong> format, we first had to group the data by <code>FQINSTID</code> with <a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a>, thereby ensuring that a Phase 1 and Phase 2 check could be performed for each woman. In preparing for this post, this approach took about 36.5 seconds. By comparison, the same task was achieved without <a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a> in <strong>wide</strong> format in just 0.16 seconds. If your workflow requires multiple comparisons between phases, the <strong>wide</strong> format may be the best choice!</p>
<p>On the other hand, many of the longitudinal modeling packages available for R require data to be in a <strong>long</strong> format - this includes both the <a href="https://cran.r-project.org/web/packages/survival/index.html">survival</a> package for Cox regression and the <a href="https://github.com/lme4/lme4">lme4</a> package for multilevel models. Users who prefer the <strong>wide</strong> format for data cleaning and exploration can manually switch to <strong>long</strong> format with help from <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a>, for example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wide <span class="sc">%&gt;%</span> <span class="fu">select</span>(FQINSTID, AGE_1, PREGNANT_1, AGE_2, PREGNANT_2)</span></code></pre></div>
<pre><code># A tibble: 17,725 × 5
   FQINSTID                                  AGE_1     PREGNANT_1 AGE_2     PREGNANT_2
   &lt;chr&gt;                                     &lt;int+lbl&gt; &lt;int+lbl&gt;  &lt;int+lbl&gt; &lt;int+lbl&gt; 
 1 uuid:0005f6d7-b7cd-46f6-8a6f-5f051b6ab4a2 30        0 [No]     31        0 [No]    
 2 uuid:0006cb76-09d1-4f2a-a92d-c12fcaf194b5 34        1 [Yes]    34        0 [No]    
 3 uuid:00204481-5cae-4188-abb3-0367d0ed9c14 17        0 [No]     18        0 [No]    
 4 uuid:002398f4-8f2d-4095-8019-c306d39cf2b9 29        0 [No]     29        0 [No]    
 5 uuid:00407300-c1e6-4e24-ab8d-8af5e1ca85a6 25        0 [No]     25        0 [No]    
 6 uuid:00413ed1-d176-44fb-a232-7e53c1db0958 32        0 [No]     32        0 [No]    
 7 uuid:0048a052-66ff-4ed5-9fa9-fc72e6dab696 38        0 [No]     39        0 [No]    
 8 uuid:004d80f0-90c6-4b77-bb4d-21d09c84fe74 38        0 [No]     38        0 [No]    
 9 uuid:00504cf5-870c-4a02-aad7-ea5d47b135ff 33        0 [No]     34        0 [No]    
10 uuid:00534792-fb84-47b4-8606-e145d74cd089 24        0 [No]     25        0 [No]    
11 uuid:0058cbb8-9892-4a60-b9ed-fb556a21f862 29        0 [No]     30        0 [No]    
12 uuid:00682e93-0483-42b4-8f8d-2e0c36a26d37 16        0 [No]     17        0 [No]    
13 uuid:007699e0-d078-4a30-ace2-6de2cfaa571a 29        0 [No]     30        0 [No]    
14 uuid:00776552-ad8a-455b-93e0-ac9d066e2a85 22        0 [No]     23        0 [No]    
15 uuid:0084cafd-e83f-45ee-9906-8a1d2d0b923a 28        0 [No]     29        0 [No]    
16 uuid:009dbdcf-f9f0-4cb6-94e2-e6a46fb23bd6 41        0 [No]     42        0 [No]    
17 uuid:00b89b1d-25e1-40f0-8e52-e06ce5525555 47        1 [Yes]    47        0 [No]    
18 uuid:00bf8df9-340f-454b-95b7-04921ef54c28 15        0 [No]     16        0 [No]    
19 uuid:00c8312a-561a-4855-840d-63a6fba578ae 22        0 [No]     22        0 [No]    
20 uuid:00f7a6fb-484e-4664-a646-79dd480ab43e 24        0 [No]     25        0 [No]    
# … with 17,705 more rows</code></pre>
<div class="page-break-after"></div>
<p>With <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a>, you can strip the suffix <code>1</code> or <code>2</code> from each variable, placing the result in a new column called <code>PHASE</code>. Then, we’ll pivot each woman’s age and pregnancy status from 2 <strong>wide</strong> columns into a single <strong>long</strong> one.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wide <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FQINSTID, AGE_1, PREGNANT_1, AGE_2, PREGNANT_2) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>FQINSTID, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">&quot;(.*)_([1-2])&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;PHASE&quot;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code># A tibble: 35,450 × 4
   FQINSTID                                  PHASE AGE       PREGNANT 
   &lt;chr&gt;                                     &lt;chr&gt; &lt;int+lbl&gt; &lt;int+lbl&gt;
 1 uuid:0005f6d7-b7cd-46f6-8a6f-5f051b6ab4a2 1     30        0 [No]   
 2 uuid:0005f6d7-b7cd-46f6-8a6f-5f051b6ab4a2 2     31        0 [No]   
 3 uuid:0006cb76-09d1-4f2a-a92d-c12fcaf194b5 1     34        1 [Yes]  
 4 uuid:0006cb76-09d1-4f2a-a92d-c12fcaf194b5 2     34        0 [No]   
 5 uuid:00204481-5cae-4188-abb3-0367d0ed9c14 1     17        0 [No]   
 6 uuid:00204481-5cae-4188-abb3-0367d0ed9c14 2     18        0 [No]   
 7 uuid:002398f4-8f2d-4095-8019-c306d39cf2b9 1     29        0 [No]   
 8 uuid:002398f4-8f2d-4095-8019-c306d39cf2b9 2     29        0 [No]   
 9 uuid:00407300-c1e6-4e24-ab8d-8af5e1ca85a6 1     25        0 [No]   
10 uuid:00407300-c1e6-4e24-ab8d-8af5e1ca85a6 2     25        0 [No]   
11 uuid:00413ed1-d176-44fb-a232-7e53c1db0958 1     32        0 [No]   
12 uuid:00413ed1-d176-44fb-a232-7e53c1db0958 2     32        0 [No]   
13 uuid:0048a052-66ff-4ed5-9fa9-fc72e6dab696 1     38        0 [No]   
14 uuid:0048a052-66ff-4ed5-9fa9-fc72e6dab696 2     39        0 [No]   
15 uuid:004d80f0-90c6-4b77-bb4d-21d09c84fe74 1     38        0 [No]   
16 uuid:004d80f0-90c6-4b77-bb4d-21d09c84fe74 2     38        0 [No]   
17 uuid:00504cf5-870c-4a02-aad7-ea5d47b135ff 1     33        0 [No]   
18 uuid:00504cf5-870c-4a02-aad7-ea5d47b135ff 2     34        0 [No]   
19 uuid:00534792-fb84-47b4-8606-e145d74cd089 1     24        0 [No]   
20 uuid:00534792-fb84-47b4-8606-e145d74cd089 2     25        0 [No]   
# … with 35,430 more rows</code></pre>
<p>Manipulating patterns in variable names with <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a> takes practice, and we imagine many users will find it easier to simply work with data in the <strong>long</strong> format from the beginning.</p>
<p>Fortunately, the IPUMS PMA extract system makes it easy to select the samples, sample members, and variables that matter to your particular research question. Choices for <strong>long</strong> and <strong>wide</strong> data formats save an additional data cleaning step, allowing you to jump into longitudinal analysis as quickly as possible.</p>
</div>
</div>
</div>



<script>
// when the page is about to reload via servr, remember the scroll position
document.addEventListener('servr:reload', function(e) {
  sessionStorage.setItem('pagedown-scroll', window.scrollY);
});
</script>
</body>
</html>
