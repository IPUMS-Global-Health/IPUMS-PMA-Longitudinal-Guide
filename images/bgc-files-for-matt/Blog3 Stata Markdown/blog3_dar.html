<h1><a href="#chapter-4-visualizing-panel-membership" id="chapter-4-visualizing-panel-membership">Chapter 4 - Visualizing Panel Membership</a></h1>
<p>Note: We have not tried to reproduce the R blog post here, but as a placeholder have developed code to reproduce the counts for the rows in the CONSORT figure.<br />
These counts could be compiled into a dataset and some code developed to make a figure similar to the one made with ggplot.</p>
<p>We will revisit the topic of whether to develop this further or not at a future date, along with the question of what code will be needed to extend this example to include data from Phase 3.</p>
<pre><code>. 
. cd &quot;Q:\BMGF - PMA IPUMS FP Blog Posts\Blog3&quot;
Q:\BMGF - PMA IPUMS FP Blog Posts\Blog3

. 
. use &quot;pma_00120.dta&quot;, clear

. 
. gen pop = .
(202,997 missing values generated)

. replace pop = 1 if country == 1 // Burkina Faso
(57,990 real changes made)

. replace pop = 2 if country == 2 &amp; geocd == 1 // Kinshasa
(20,831 real changes made)

. replace pop = 3 if country == 2 &amp; geocd == 2 // Kongo Central
(17,625 real changes made)

. replace pop = 4 if country == 7 // Kenya
(83,645 real changes made)

. replace pop = 5 if country == 9 &amp; geong == 4 // Kano
(10,970 real changes made)

. replace pop = 6 if country == 9 &amp; geong == 2 // Lagos
(11,936 real changes made)

. 
. label define pop ///
&gt;            1 &quot;Burkina Faso&quot; ///
&gt;            2 &quot;DRC-Kinshasa&quot; ///
&gt;            3 &quot;DRC-Kongo Central&quot; ///
&gt;            4 &quot;Kenya&quot; ///
&gt;            5 &quot;Nigeria-Kano&quot; ///
&gt;            6 &quot;Nigeria-Lagos&quot;, replace

. 
. label values pop pop

. 
. table ( pop ) ( ) ( ), nototals missing

--------------------------------
                    |  Frequency
--------------------+-----------
pop                 |           
  Burkina Faso      |     57,990
  DRC-Kinshasa      |     20,831
  DRC-Kongo Central |     17,625
  Kenya             |     83,645
  Nigeria-Kano      |     10,970
  Nigeria-Lagos     |     11,936
--------------------------------

. 
. preserve

. 
. ********************************************************************************
. 
. use &quot;pma_00120.dta&quot;, clear

. drop if missing(hhid_1) // focus on Phase 1
(98,687 observations deleted)

. bysort hhid_1: keep if _n == 1 // keep one row per household
(80,964 observations deleted)

. gen completed = inlist(resulthq_1,1,5) // all or part of Phase I HH q

. tab completed

  completed |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        852        3.65        3.65
          1 |     22,494       96.35      100.00
------------+-----------------------------------
      Total |     23,346      100.00

. 
. ********************************************************************************
. 
. restore

. 
. * Step 1
. * group the data by pop and gen new var step = 1 and keep
. sort pop

. gen step = 1

. gen keep = resulthq_1 == 1 | resulthq_1 == 5

. * generate a new data to have keep == true only and tab step keep (group by pop)
. table (pop) ( step keep ) () if keep == 1, nototals missing zerocounts

-----------------------------
                    |   step 
                    |       1
                    |   keep 
                    |       1
--------------------+--------
pop                 |        
  Burkina Faso      |  30,210
  DRC-Kinshasa      |  10,309
  DRC-Kongo Central |   8,847
  Kenya             |  42,308
  Nigeria-Kano      |   5,722
  Nigeria-Lagos     |   6,062
-----------------------------

. 
. * These counts correspond to those at the top of the figure labeled
. * Phase 1 household members
. 
. 
. * Step 2
. * filter hh so that only have keep == true then update the step var to 2 and keep var
. keep if keep == 1
(99,539 observations deleted)

. replace step = 2
(103,458 real changes made)

. drop keep

. gen keep = eligible_1 == 1

. * tab step and keep, with the new tab table generate label (group by pop)
. table (pop) ( step keep ) (), nototals missing zerocounts

-------------------------------------
                    |       step     
                    |         2      
                    |       keep     
                    |       0       1
--------------------+----------------
pop                 |                
  Burkina Faso      |  23,050   7,160
  DRC-Kinshasa      |   7,539   2,770
  DRC-Kongo Central |   6,845   2,002
  Kenya             |  32,609   9,699
  Nigeria-Kano      |   4,589   1,133
  Nigeria-Lagos     |   4,490   1,572
-------------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Not eligible for Phase 1 FQ
. 
. 
. 
. keep if keep == 1
(79,122 observations deleted)

. replace step = 3
(24,336 real changes made)

. drop keep

. gen keep = resultfq_1 == 1 | resultfq_1 == 5

. table (pop) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       3     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |  370   6,790
  DRC-Kinshasa      |  131   2,639
  DRC-Kongo Central |   32   1,970
  Kenya             |  141   9,558
  Nigeria-Kano      |    6   1,127
  Nigeria-Lagos     |   65   1,507
----------------------------------

. 
. 
. 
. * Step 4
. * filter hh to only have keep == true then update the step var to 4 and keep var
. keep if keep == 1
(745 observations deleted)

. replace step = 4
(23,591 real changes made)

. drop keep

. gen keep = surveywilling_1 == 1

. * tab step and keep, with the new tab table generate label (group by pop)
. table (pop) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       4     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |  193   6,597
  DRC-Kinshasa      |   61   2,578
  DRC-Kongo Central |   50   1,920
  Kenya             |  661   8,897
  Nigeria-Kano      |   29   1,098
  Nigeria-Lagos     |   82   1,425
----------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Consented at Phase 1 to Phase 2 follow-up
. 
. ********************************************************************************
. 
. * Step 5
. * filter hh to only have keep == true then update the step var to 5 and keep var
. keep if keep == 1
(1,076 observations deleted)

. replace step = 5
(22,515 real changes made)

. drop keep

. gen keep = age_1 &lt; 49

. * tab step and keep, with the new tab table generate label (group by pop)
. table (pop) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       5     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |   65   6,532
  DRC-Kinshasa      |   29   2,549
  DRC-Kongo Central |   18   1,902
  Kenya             |  100   8,797
  Nigeria-Kano      |   13   1,085
  Nigeria-Lagos     |   26   1,399
----------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Women aged 15-49 at Phase 2
. 
. ********************************************************************************
. 
. * Step 6
. * filter hh to only have keep == true then update the step var to 6 and keep var; also
&gt;  update samedw var
. keep if keep == 1
(251 observations deleted)

. replace step = 6
(22,264 real changes made)

. drop keep

. gen keep = resulthq_2 == 1

. gen samedw = samedwelling_2 == 1

. *update samedw
. replace samedw = 1 if keep == 0 
(1,846 real changes made)

. *table step and keep
. table (pop samedw) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       6     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |             
    samedw          |             
      0             |    0     337
      1             |  431   5,764
  DRC-Kinshasa      |             
    samedw          |             
      0             |    0     495
      1             |  311   1,743
  DRC-Kongo Central |             
    samedw          |             
      0             |    0     215
      1             |  165   1,522
  Kenya             |             
    samedw          |             
      0             |    0     703
      1             |  764   7,330
  Nigeria-Kano      |             
    samedw          |             
      0             |    0      28
      1             |   35   1,022
  Nigeria-Lagos     |             
    samedw          |             
      0             |    0      45
      1             |  146   1,208
----------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Completed all the Phase 2 HQ survey
. 
. ********************************************************************************
. 
. *rbind the hh_plot with this table
. 
. * Step 7
. * Filter hh to only have keep == true then update the step var to 7 and keep var
. keep if keep == 1
(1,852 observations deleted)

. replace step = 7
(20,412 real changes made)

. drop keep

. gen keep = hhmemstat_2 == 1 | hhmemstat_2 == 99

. *tab step and keep, with the new tab table generate n (as string) and label
. table (pop samedw) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       7     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |             
    samedw          |             
      0             |    1     336
      1             |  393   5,371
  DRC-Kinshasa      |             
    samedw          |             
      0             |    3     492
      1             |  139   1,604
  DRC-Kongo Central |             
    samedw          |             
      0             |    2     213
      1             |  178   1,344
  Kenya             |             
    samedw          |             
      0             |   13     690
      1             |  941   6,389
  Nigeria-Kano      |             
    samedw          |             
      0             |    0      28
      1             |   46     976
  Nigeria-Lagos     |             
    samedw          |             
      0             |    0      45
      1             |   91   1,117
----------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Resident in dwelling
. 
. ********************************************************************************
. 
. * Step 8
. * filter hh to only have keep == true then update the step var to 8 and keep var
. keep if keep == 1
(1,807 observations deleted)

. replace step = 8
(18,605 real changes made)

. drop keep

. gen keep = resultfq_2 == 1

. *tab step and keep, with the new tab table generate n (as string) and label
. table (pop samedw) ( step keep ) (), nototals missing zerocounts

----------------------------------
                    |      step   
                    |       8     
                    |      keep   
                    |    0       1
--------------------+-------------
pop                 |             
  Burkina Faso      |             
    samedw          |             
      0             |    5     331
      1             |  211   5,160
  DRC-Kinshasa      |             
    samedw          |             
      0             |    5     487
      1             |   85   1,519
  DRC-Kongo Central |             
    samedw          |             
      0             |    5     208
      1             |   18   1,326
  Kenya             |             
    samedw          |             
      0             |    3     687
      1             |   58   6,331
  Nigeria-Kano      |             
    samedw          |             
      0             |    0      28
      1             |    3     973
  Nigeria-Lagos     |             
    samedw          |             
      0             |    0      45
      1             |   33   1,084
----------------------------------

. 
. * These counts correspond to those in the figure labeled
. * Completed all of the Phase 2 FQ survey
. 
. ********************************************************************************
. 
. * Step 9
. * filter hh to only have keep == true then update the step var to 9 and keep = TRUE
. keep if keep == 1
(426 observations deleted)

. replace step = 9
(18,179 real changes made)

. drop keep

. gen keep = 1

. *tab step and keep, with the new tab table generate n (as string) and label
. table (pop) ( step keep ) (), nototals missing zerocounts

----------------------------
                    |   step
                    |      9
                    |   keep
                    |      1
--------------------+-------
pop                 |       
  Burkina Faso      |  5,491
  DRC-Kinshasa      |  2,006
  DRC-Kongo Central |  1,534
  Kenya             |  7,018
  Nigeria-Kano      |  1,001
  Nigeria-Lagos     |  1,129
----------------------------

. 
. * These counts correspond to those in the figure labeled
. * Panel Members at Phase 2
. 
</code></pre>
<p><strong>Note:</strong> Again, not clear whether we will replicate the narrative from this blog post, but I&rsquo;m posting the footnotes here in case we decide to use them.</p>
<section class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Questionnaires administered in each
country may vary from this <strong>Core Household Questionnaire</strong>
- <a href="https://pma.ipums.org/pma/enum_materials.shtml">click
here</a> for details.<a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Questionnaires administered in each
country may vary from this <strong>Core Female Questionnaire</strong> -
<a href="https://pma.ipums.org/pma/enum_materials.shtml">click here</a>
for details.<a href="#fnref2" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>Women who completed the Phase 1
Female Questionnaire but declined to participate in the panel were given
an opportunity to join the panel again at Phase 2 (if eligible). They
are not panel members as shown in <a
href="https://pma.ipums.org/pma-action/variables/PANELWOMAN">PANELWOMAN_2</a>,
but they may be listed as such in <a
href="https://pma.ipums.org/pma-action/variables/PANELWOMAN">PANELWOMAN_3</a>
if they agree to participation in the panel going forward.<a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>The “study area” is area within which
resident enumerators should attempt to find panel women that have moved
out of their Phase 1 dwelling. This may extend beyond the woman’s
original EA as determined by in-country administrators - see <a
href="https://www.pmadata.org/data/survey-methodology">PMA Phase 2 and
Phase 3 Survey Protocol</a> for details.<a href="#fnref4"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
